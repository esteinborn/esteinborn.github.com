function GithubRepo(t){this.description=t.description,this.forks=t.forks,this.name=t.name,this.open_issues=t.open_issues,this.pushed_at=t.pushed_at,this.url=t.url,this.watchers=t.watchers}function Github(t,s){var e={iconStars:!0,iconForks:!0,iconIssues:!1}
this.element=t,this.$container=$(t),this.repo=this.$container.attr("data-repo"),this.options=$.extend({},e,s),this._defaults=e,this.init(),this.displayIcons()}GithubRepo.prototype.toHTML=function(){return this.pushed_at=this._parsePushedDate(this.pushed_at),this.url=this._parseURL(this.url),$("<div class='github-box'><div class='github-box-header'><h3><a href='"+this.url+"'>"+this.name+"</a></h3><div class='github-stats'><a class='repo-stars' title='Stars' data-icon='7' href='"+this.url+"/stargazers'>"+this.watchers+"</a><a class='repo-forks' title='Forks' data-icon='f' href='"+this.url+"/network'>"+this.forks+"</a><a class='repo-issues' title='Issues' data-icon='i' href='"+this.url+"/issues'>"+this.open_issues+"</a></div></div><div class='github-box-content'><p>"+this.description+" &mdash; <a href='"+this.url+"#readme'>Read More</a></p></div><div class='github-box-download'><p class='repo-update'>Latest commit to <strong>master</strong> on "+this.pushed_at+"</p><a class='repo-download' title='Download as zip' data-icon='w' href='"+this.url+"/zipball/master'></a></div></div>")},GithubRepo.prototype._parsePushedDate=function(t){var s=new Date(t)
return s.getFullYear()+"/"+(s.getMonth()+1)+"/"+s.getDate()},GithubRepo.prototype._parseURL=function(t){return t.replace("api.","").replace("repos/","")},Github.prototype.init=function(){var t=this.getCache()
return null!==t?(this.applyTemplate(JSON.parse(t)),void 0):(this.requestData(this.repo),void 0)},Github.prototype.displayIcons=function(){var t=this.options,s=$(".repo-stars"),e=$(".repo-forks"),i=$(".repo-issues")
s.css("display",t.iconStars?"inline-block":"none"),e.css("display",t.iconForks?"inline-block":"none"),i.css("display",t.iconIssues?"inline-block":"none")},Github.prototype.requestData=function(t){var s=this
$.ajax({url:"https://api.github.com/repos/"+t,dataType:"jsonp",success:function(t){var e=t.data,i=t.meta.status>=400&&e.message
return i?(s.handleErrorRequest(e),void 0):(s.handleSuccessfulRequest(e),void 0)}})},Github.prototype.handleErrorRequest=function(t){console.warn(t.message)},Github.prototype.handleSuccessfulRequest=function(t){this.applyTemplate(t),this.setCache(t)},Github.prototype.setCache=function(t){window.sessionStorage&&window.sessionStorage.setItem("gh-repos:"+this.repo,JSON.stringify(t))},Github.prototype.getCache=function(){return window.sessionStorage?window.sessionStorage.getItem("gh-repos:"+this.repo):!1},Github.prototype.applyTemplate=function(t){var s=new GithubRepo(t),e=s.toHTML()
e.appendTo(this.$container)},function(t){t.fn.github=function(s){return this.each(function(){t(this).data("plugin_github")||t(this).data("plugin_github",new Github(this,s))})}}(window.jQuery||window.Zepto,window)
